# CP2105 USB Host Driver for STM32

This repository contains the USB Host driver implementation for STM32 to communicate with the Silicon Labs CP2105, a dual USB-to-UART bridge device. This driver is specifically developed to replace the standard STM32 USB CDC class, which does not support vendor-specific devices like CP2105.

## Overview

CP2105 is a composite USB device that provides dual UART interfaces. The STM32 CDC class does not natively support this, so a custom driver was developed to handle the CP2105's unique control requests and data communication. The driver provides the ability to set baud rates, transmit, and receive data on both UART ports of the CP2105.

### Key Features
- Supports communication with CP2105's dual UART channels (Standard Port and Enhanced Port).
- Implements baud rate configuration for both UART channels.
- Supports data transmission and reception via USB bulk transfer.
- Provides user callbacks for data transmission and reception completion.

## Installation

To integrate this driver into your STM32 project, follow the steps below:

1. **Place the Driver Files:**
   Copy `usbh_cp2105.c` and `usbh_cp2105.h` into the same directory where your USB Host files are located (e.g., where `usbh_cdc.c` and `usbh_cdc.h` are autogenerated by CubeMX).

2. **Register the CP2105 Class in `usb_host.c`:**
   In the `USB_HOST/App/usb_host.c` file, comment out the CDC class registration and replace it with the CP2105-specific registration. Follow the steps shown in the example figure below:

   **Figure 1: File Directory for the USB Host Code**

   ```c
   // Comment out the CDC registration
   // USBH_RegisterClass(&hUsbHostFS, USBH_CDC_CLASS);

   // Register CP2105 class 
   USBH_RegisterClass(&hUsbHostFS, USBH_CP2105_CLASS);
    ```

### Update Main Application:
In the `main.c` file, you can handle the transmission and reception through the CP2105 dual UART ports as demonstrated below:

```c
if (Appli_state == APPLICATION_READY) {
    uint32_t baud_rate = 921600;
    USBH_CP2105_SetBaudRate(&hUsbHostFS, baud_rate, CP2105_STD_PORT);
    
    uint8_t tx_buffer[] = "Hello CP2105!";
    USBH_CP2105_Transmit(&hUsbHostFS, tx_buffer, sizeof(tx_buffer), CP2105_STD_PORT);
}

```

